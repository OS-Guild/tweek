version: 0.0.{build}
configuration: Release
before_build:
- cmd: nuget restore -verbosity quiet
build:
  verbosity: quiet
test_script:
- ps: "$xunitConsoleRunner = \"$env:APPVEYOR_BUILD_FOLDER\\packages\\xunit.runner.console.2.1.0\\tools\\xunit.console.exe\"\n\n# Start Local Service for Smoke Tests\nStart-Job -Name RunLocalDeployment -ScriptBlock { \n    & 'C:\\Program Files (x86)\\IIS Express\\iisexpress.exe' /port:1234 /path:\"$env:APPVEYOR_BUILD_FOLDER\\Tweek.ApiService\"\n}\n\nWait-Job -Name RunLocalDeployment -Timeout 5\n\n$Env:TWEEK_SMOKE_TARGET = \"http://localhost:1234\"\n\n# Run Smoke Tests\n$testAssemblies = @(\n    \"$env:APPVEYOR_BUILD_FOLDER\\Engine.Tests\\bin\\Release\\Engine.IntegrationTests.dll\",\n    \"$env:APPVEYOR_BUILD_FOLDER\\Engine.Core.Tests\\bin\\Release\\Engine.Core.Tests.dll\",\n    \"$env:APPVEYOR_BUILD_FOLDER\\Tweek.ApiService.Tests\\bin\\Release\\Tweek.ApiService.Tests.dll\",\n    \"$env:APPVEYOR_BUILD_FOLDER\\JPad\\Tweek.JPad.Tests\\bin\\Release\\Tweek.JPad.Tests.dll\"\n)\n\n& $xunitConsoleRunner $testAssemblies\n\n$resultsCode = $LastExitCode\n\n# Stop Local Service\nReceive-Job -Name RunLocalDeployment | Write-Host\nStop-Job -Name RunLocalDeployment \nRemove-Job -Name RunLocalDeployment\n\nexit $resultsCode"